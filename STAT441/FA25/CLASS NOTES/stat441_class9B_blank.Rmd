---
title: 'STAT 441: Foundations of MLR Inference'
output:
  pdf_document:
    toc: true
    toc_depth: '5'
  html_document:
    toc: true
    collapsed: false
    toc_float: true
    toc_depth: 5
---

### Learning Objectives 

Students will learn how to ...

* Estimate the nuisance parameter
* Estimate the standard errors for $\hat{\beta}_j$'s
* Compute the coverance between $\hat{\beta}_1$ and $\hat{\beta}_2$

### CODING TOGETHER 

#### A. Import the Data 

These data are from the textbook "Introduction to Linear Regression Analysis (3rd ed)", by Montgomery, Peck and Vining.


**Motivation**: A soft drink bottler is analyzing the vending machine service routes in his distribution system.  He is interested in predicting the amount of time required by the route driver to service the vending machines in an outlet.  This service activity includes stocking the machine with beverage products and minor maintenance or housekeeping.  The industrial engineer responsible for the study suggested that the two most important variables affecting the delivery time (Y) are the number of cases of product stocked (x1) and the distance walked by the route driver  (x2) .  The engineer collected 25 observations on delivery time. 

```{r}
## LOAD THE TEXTBOOK PACKAGE
#install.packages("MPV")
library(MPV)

data("softdrink")

str(softdrink)
```
Variables: 
* $Y$: Delivery Time
* $x_1$: Number of cases of product stocked
* $x_2$: Distanced walked by the route driver. 

#### B. Rename Variables

```{r}
### RENAME VARIABLES SO THEY ARE EASIER TO WORK WITH
library(tidyverse)

softdrink<-softdrink%>%
  rename(delTime=y, 
         numCases=x1, 
         distance=x2)

str(softdrink)
```

#### C. Fit the Model

The model for two explanatory variables: 

$$Y_i=\beta_0+\beta_1x_{i1}+\beta_2x_{i2}+\varepsilon_i$$

```{r}
## USE LM
mod <- lm(delTime~numCases+distance, data=softdrink)

summary(mod)
```


### VERIFY FROM SCRATCH


#### D. Estimate the Nuissance Parameter

Recall: $s=\sqrt{MS(Res)}$

```{r}
## DEFINE THE VARIABLES n and p 

## INSERT CODE HERE ## 

## MS(RES)
## INSERT CODE HERE ## 

## VERIFY
## INSERT CODE HERE ## 
```



#### E. Design Matrix

First need to define the design matrix

```{r}
### DESIGN MATRIX
xMat<-matrix(c(rep(1, dim(softdrink)[1]), 
            softdrink$numCases, 
            softdrink$distance),
          nrow=dim(softdrink)[1])

```

#### F. Compute the Variance-Covariance Matrix

The variance-covariance matrix is symmetric. 

```{r}
### VARIANCE-COVARIANCE MAT
## INSERT CODE HERE ## 
```

#### G. Compute the Standard Errors 

Standard errors can be computed from the diagonals. 

```{r}
## STANDARD ERRORS
## INSERT CODE HERE ## 

## VERIFY 
## INSERT CODE HERE ## 
```




